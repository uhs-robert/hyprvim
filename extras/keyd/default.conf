# /etc/keyd/default.conf
#
#    ██╗  ██╗███████╗██╗   ██╗██████╗ ██╗   ██╗██╗███╗   ███╗
#    ██║ ██╔╝██╔════╝╚██╗ ██╔╝██╔══██╗██║   ██║██║████╗ ████║
#    █████╔╝ █████╗   ╚████╔╝ ██║  ██║██║   ██║██║██╔████╔██║
#    ██╔═██╗ ██╔══╝    ╚██╔╝  ██║  ██║╚██╗ ██╔╝██║██║╚██╔╝██║
#    ██║  ██╗███████╗   ██║   ██████╔╝ ╚████╔╝ ██║██║ ╚═╝ ██║
#    ╚═╝  ╚═╝╚══════╝   ╚═╝   ╚═════╝   ╚═══╝  ╚═╝╚═╝     ╚═╝
#
################################################################################
# KEYDVIM - BASIC VIM-STYLE KEYBINDINGS AND SHORTCUTS
################################################################################
#
# - When 'capslock' is tapped (pressed + released), it behaves as the ESC key
# - When 'capslock' is held it behaves like a 'ctrl' key modifier
# - When 'tab' is held, enter a "vim-lite" layer (keybinds only)
#     This is useful for people who don't run Hyprland but still want a minimal,
#     universal vim-like experience at the OS level.
#
################################################################################
#
# Limitations:
#   This config only remaps keys (no shell script execution and no status
#   indicator), so this is an intentionally light setup but it is still robust.
#   Useful for quick one-off `hjkl` movement or non-advanced text manipulation and
#   navigation. Although HyprVim is currently the more comprehensive solution for
#   vim emulation, this could be edited to used shell scripts; but do so with
#   care as scripts run by keyd are run as root. Also every key must be unmapped
#   individually to prevent fallthrough.
#
################################################################################
#
# How to Exit "vim-lite":
#   Like vim, you may get trapped in vim-lite. To escape, here are two ways:
#     - `<ALT>+<ESCAPE>` or `<CAPSLOCK>+<ESCAPE>` will exit vim-lite
#     - `<backspace>+<escape>+<enter>` will terminate keyd
#
################################################################################

# ---------------------------------------------------------------------------- #
# !-- IDS
# ---------------------------------------------------------------------------- #

[ids]

*

# ---------------------------------------------------------------------------- #
# !-- MAIN
# ---------------------------------------------------------------------------- #

# NOTE: Capslock or Control to act as escape when tapped. Pick one or both.
# If you opt to disable then search and comment out each instance in config.
[main]

capslock = overload(ctrl_vim, esc)
leftcontrol = overload(ctrl_vim, esc)
tab = overload(normal_mode, tab)

# ---------------------------------------------------------------------------- #
# !-- ALT
# ---------------------------------------------------------------------------- #

# Global escape hatch when trapped inside a toggled mode
[alt]

capslock = clear()
esc = clear()

[altgr]

capslock = clear()
esc = clear()

# ---------------------------------------------------------------------------- #
# !-- CTRL VIM
# ---------------------------------------------------------------------------- #

# Permanently toggle vim-lite: [TAB]+[BACKSPACE] while holding CAPSLOCK or CTRL
[ctrl_vim:C]

backspace = toggle(normal_mode)
# WARN: To exit this mode, use global escape hatch above: [ALT]+[ESCAPE]

# ---------------------------------------------------------------------------- #
# !-- SHIFT VIM
# ---------------------------------------------------------------------------- #

# Shortcut to v-line
[vim_shift:S]

v = swapm(vline_mode, macro(end S-home))

# ---------------------------------------------------------------------------- #
# !-- NORMAL MODE
# ---------------------------------------------------------------------------- #

[normal_mode]

## Movement
h = left
j = down
k = up
l = right
H = home
L = end
leftshift = swap(vim_shift)
rightshift = swap(vim_shift)
b = C-left
B = C-left
w = C-right
W = C-right
e = macro(right C-right left)
E = macro(right C-right left)
u = C-z
C-r = C-y
C-d = pagedown
C-u = pageup
g = oneshot(g_mode)
G = C-end
0 = home
S-4 = end
x = delete
S-x = backspace
y = oneshot(y_mode)
d = oneshot(d_mode)
C = macro(S-end C-x esc)
C-y = scrollup
p = C-v
P = S-insert
/ = C-f
? = C-f
n = F3
N = S-F3
esc = toggle(normal_mode)
a = macro(right esc)
A = macro(end esc)
i = toggle(normal_mode)
I = toggle(normal_mode)
v = toggle(visual_mode)
V = toggle(vline_mode)

# ---------------------------------------------------------------------------- #
# ---------------------------------------------------------------------------- #
# !-- G MODE
# ---------------------------------------------------------------------------- #

[g_mode]

## Mode changes
g = C-home
e = macro(C-left C-right)


# ---------------------------------------------------------------------------- #
# !-- VISUAL MODE
# ---------------------------------------------------------------------------- #

[visual_mode]

## Movement
h = S-left
j = S-down
k = S-up
l = S-right
0 = S-home
S-4 = S-end


## Mode Switches
i = oneshot(i_visual_mode)
a = oneshot(i_visual_mode)
g = oneshot(g_visual_mode)
v = swap(normal_mode)
esc = swap(normal_mode)
capslock = swap(normal_mode)
leftcontrol = swap(normal_mode)
leftshift = layer(shift_vim)
rightshift = layer(shift_vim)

[g_visual_mode]
g = C-S-home

# ---------------------------------------------------------------------------- #
# !-- VISUAL LINE MODE
# ---------------------------------------------------------------------------- #

[vline_mode]
j = S-down
k = S-up


## Mode Switches
g = oneshot(g_vline_mode)
v = swapm(visual_mode, left)
esc = swap(normal_mode)
capslock = swap(normal_mode)

# ---------------------------------------------------------------------------- #
# !-- G VISUAL LINE MODE
# ---------------------------------------------------------------------------- #

[g_vline_mode]
g = macro(end C-S-home)

